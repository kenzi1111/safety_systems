{% extends 'base.html' %}

{% block content %}

    {% comment %} 単一の住所しか表示できない {% endcomment %}
    {% comment %} 
    {% if user.is_authenticated  %}
    <div class="col-12">
        <div class="row">
            <h2 class="h2">ユーザの住所一覧</h2>
        </div>
        <div class="row">
            <div class="col-12">
                <div class="card-columns">
                    <iframe id='map'
                        src='https://www.google.com/maps/embed/v1/place?key={{google_maps_api_key}}&q={{ UseProfile.address|urlencode }}'
                        width='100%'
                        height='320'
                        frameborder='0'>
                    </iframe>
                </div>
            </div>
        </div>
    </div> 

    <div class="row justify-content-center"> 
{% endcomment %}

<div class="row justify-content-center">
    {% if user.is_authenticated %}
    <div class="col-12">
        <div id="map" style="height: 500px; width: 100%;"></div>
    </div>

    <script>
        function initMap() {
            var map = new google.maps.Map(document.getElementById('map'), {
                zoom: 10,
                center: {lat: 35.6895, lng: 139.6917} // 東京の座標。適宜変更してください。
            });

            var addresses = {{ addresses|safe }};
            
            addresses.forEach(function(address) {
                // ここで住所を緯度経度に変換して、マーカーを設置します。
                // ジオコーディングは必要に応じて行ってください。
            });
        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key={{google_maps_api_key}}&callback=initMap" async defer></script>

    {% else %}
    <div class="col-12">
        <div class="row">
            <div class="col-12">
                <h5 class="h5">上記のリンクよりログインしてください</h5>
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}